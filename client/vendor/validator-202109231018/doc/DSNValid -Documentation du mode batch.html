<?xml version='1.0' encoding='utf-8' ?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/></head><body><p><a href="./../index.html">&lt;&lt; Retour à l&#8217;index </a></p><h1 id="ValidationDSNenlignedecommande">Validation DSN en ligne de commande</h1><ol class="toc" style="list-style: circle;"><li><a href="#ValidationDSNenlignedecommande">Validation DSN en ligne de commande</a><ol style="list-style: circle;"><li><a href="#Prrequis">Prérequis</a></li><li><a href="#Commandedinvocationdelavalidation">Commande d'invocation de la validation</a></li><li><a href="#Codesderreurpossibles">Codes d'erreur possibles</a></li><li><a href="#Configurationjava">Configuration java</a></li><li><a href="#Encodingsouswindows">Encoding sous windows</a></li></ol></li></ol><h2 id="Prrequis">Prérequis</h2><p>Pour pouvoir utiliser l&#8217;application en mode ligne de commande, il faut :</p><ul><li>une machine avec un système d&#8217;exploitation Linux 32bits ou Windows 32 bits,</li><li>l&#8217;application DSNVal prsente sur la machine,</li><li>une machine virtuelle Java JDK 6 32 Bits SUN installe sur la machine.</li></ul><p>La machine sur laquelle est excute la validation en mode ligne de commande n&#8217;a pas besoin de serveur graphique.</p><h2 id="Commandedinvocationdelavalidation">Commande d&#8217;invocation de la validation</h2><p>Le plugin «fr.cnav.autocontrole.headless» permet de valider un message DSN en mode ligne de commande. Ce plugin est intgr à l&#8217;excutable DSN-Val. Pour excuter la validation, il faut se mettre dans le rpertoire d&#8217;installation de l&#8217;excutable DSN-Val (comme repère, ce rpertoire doit contenir : DSN-Validateur, plugins, features, ...) et ensuite lancer la commande suivante :</p><p>Pour Windows : </p><pre><code>DSN-ValidateurModeBatchWin32.cmd [{--help|-h}]
</code></pre><pre><code>DSN-ValidateurModeBatchWin32.cmd \
		[{--output|-o} cheminDuRepertoireCible] [--grouping|-g] [{--limit|-l} nbreAnomalieLimite]  \
		[{--noCheckUpdate|-nc}]cheminDuMessageDsn.dns
</code></pre><p>Pour linux : </p><pre><code>./DSN-ValidateurModeBatchLinux32.sh [{--help|-h}]
</code></pre><pre><code>./DSN-ValidateurModeBatchLinux32.sh \
		[{--output|-o} cheminDuRepertoireCible] [{--grouping|-g}]  [{--limit|-l} nbreAnomalieLimite]  \
		[{--noCheckUpdate|-nc}]cheminDuMessageDsn.dns
</code></pre><p>Voici la description des paramètres de lancement :</p><ul><li>{--help|-h} : Affiche l&#8217;aide de la commande (paramètre optionnel)</li><li>{--output|-o} cheminDuRepertoireCible : Indique le chemin du rpertoire cible (paramètre optionnel). Si le paramètre n&#8217;est pas indiqu, le rpertoire sera celui contenant le fichier DSN à valider.</li><li>{--grouping|-g} : Activation de la mutualisation des anomalies.</li><li>{--limit|-l} nbreAnomalieLimite : Limite du nombre d&#8217;anomalies que le validateur doit prsenter (paramètre optionnel). Si le paramètre n&#8217;est pas indiqu, la validation se fait sans limite.</li><li>{--noCheckUpdate|-nc} : Dsactive la vrification de la version de l&#8217;outil (paramètre optionnel) . Si le paramètre n&#8217;est pas indiqu, la vrification est ralise, alors deux cas peuvent intervenir :<ul><li>une mise à jour est disponible : la validation n&#8217;est pas ralise et le message suivant est renvoy : 'Le produit doit être mis à jour pour raliser la validation avec ces options (sans --noCheckUpdate). Il faut utiliser le produit en mode graphique pour raliser la mise à jour du produit. La validation peut être ralise sans faire la mise à jour en utilisant l&#8217;option --noCheckUpdate.'</li><li>le produit est djà à jour : La validation est effectue.</li></ul></li></ul><p>Voici une copie d&#8217;cran de l&#8217;utilisation sur une machine linux sans utilisation du paramètre output : </p><p><img border="0" src="validate1.png"/></p><p>Voici une copie d&#8217;cran de l&#8217;utilisation sur une machine linux avec utilisation du paramètre output : </p><p><img border="0" src="validate2.png"/></p><h2 id="Codesderreurpossibles">Codes d&#8217;erreur possibles</h2><table style="border:1px solid black"><tr style="background:#ddd"><th>Nom </th><th>Message </th><th>Code </th></tr><tr style="background:#ddd"><td>EC_NO_ERROR </td><td>No error </td><td>0 </td></tr><tr style="background:#ddd"><td>EC_NO_INPUT_FILE </td><td>Vous devez fournir un fichier DSN en paramètre. </td><td>1 </td></tr><tr style="background:#ddd"><td>EC_INPUT_FILE_NOT_EXIST </td><td>Le fichier &#8249;%s&#8250; n&#8217;existe pas. </td><td>2 </td></tr><tr style="background:#ddd"><td>EC_INVALID_LIMIT_ANOMALIE </td><td>La limite du nombre d&#8217;anomalies passe en paramètre &#8249;%s&#8250; n&#8217;est pas valide (doit être un entier). </td><td>4 </td></tr><tr style="background:#ddd"><td>EC_INVALID_OPTION </td><td>Option invalide. </td><td>5 </td></tr><tr style="background:#ddd"><td>EC_OUTPUT_DIR_PARMETER_NOT_EXIST </td><td>Le rpertoire &#8249;%s&#8250; pass en paramètre doit exister. </td><td>6 </td></tr><tr style="background:#ddd"><td>EC__OUTPUT_PARMETER_IS_NOT_DIR </td><td>La ressource &#8249;%s&#8250; passe en paramètre doit être un rpertoire. </td><td>7 </td></tr><tr style="background:#ddd"><td>EC_MUST_UPDATE_PRODUCT </td><td>Le produit doit être mis à jour pour raliser la validation avec ces options (sans --noCheckUpdate). Vous devez utiliser le produit en mode graphique pour raliser la mise à jour du produit.La validation peut être ralise sans faire la mise à jour en utilisant l&#8217;option --noCheckUpdate. </td><td>8 </td></tr><tr style="background:#ddd"><td>EC_UPDATESITE_NOT_AVAILABLE </td><td>L&#8217;update site &#8249;%s&#8250; est inaccessible. La vrification du besoin de mise à jour du produit ne peut pas être faite. La validation peut être ralise malgr ceci en utilisant l&#8217;option --noCheckUpdate. </td><td>9 </td></tr><tr style="background:#ddd"><td>EC_EMPTY_UPDATESITE </td><td>L&#8217;update site n&#8217;est pas configur, il peut être indiqu dans le fichier de configuration DSN-Validateur.ini. La vrification du besoin de mise à jour du produit ne peut pas être faite. La validation peut être ralise malgr ceci en utilisant l&#8217;option --noCheckUpdate. </td><td>10 </td></tr><tr style="background:#ddd"><td>EC_NEED_HELP </td><td>Vous avez besoin d&#8217;aide. </td><td>11 </td></tr><tr style="background:#ddd"><td>CANNOT_CREATE_PRJ </td><td>Le cration du projet %s a échoué (%s). </td><td>21 </td></tr><tr style="background:#ddd"><td>CANNOT_PERPARE_PRJ </td><td>La preparation du projet %s à échoué (%s). </td><td>22 </td></tr><tr style="background:#ddd"><td>CANNOT_REFRESH_FOLDER </td><td>Le rafaichissment des rpertoires de validation ont échoué. </td><td>23 </td></tr><tr style="background:#ddd"><td>CANNOT_PROCESS_SYNTACTIC_VALIDATION </td><td>La validation syntaxique a échoué. </td><td>24 </td></tr><tr style="background:#ddd"><td>CANNOT_PROCESS_SEMAMTIC_VALIDATION </td><td>La validation semantique a échoué. </td><td>25 </td></tr><tr style="background:#ddd"><td>CANNOT_LOAD_FILE </td><td>Le chargement du fichier &#8249;%s&#8250; a échoué. </td><td>26 </td></tr><tr style="background:#ddd"><td>CANNOT_CLOSE_FILE </td><td>La fermeture du fichier &#8249;%s&#8250; a échoué. </td><td>27 </td></tr><tr style="background:#ddd"><td>CANNOT_CREATE_NORME_DESCRIPTOR </td><td>La création du norme descripteur &#8249;%s&#8250; a échouée. </td><td>28 </td></tr><tr style="background:#ddd"><td>CANNOT_EXPORT_CURRENT_REPORT </td><td>L&#8217;exportation du rapport du fichier dsn courant dans le rapport &#8249;%s&#8250; dans le rpertoire contenteur %s a échoué. Verifier la validit du rpertoire. </td><td>30 </td></tr><tr style="background:#ddd"><td>CANNOT_EXPORT_HTML </td><td>L&#8217;exportation html n&#8217;est pas encore supporté. </td><td>31 </td></tr><tr style="background:#ddd"><td>CANNOT_EXPORT_XML </td><td>L&#8217;export XML a échoué. </td><td>32 </td></tr><tr style="background:#ddd"><td>ERROR_PATH_NOT_FILE </td><td>Le chemin &#8249;%s&#8250; ne correspond pas à un fichier. </td><td>32 </td></tr><tr style="background:#ddd"><td>ERROR_REPORT_CREATION </td><td>La creation du rapport de %s a échoué ( %s ). </td><td>33 </td></tr><tr style="background:#ddd"><td>ERROR_PROCESS_CONVERTION </td><td>La conversion a échoué. </td><td>34 </td></tr><tr style="background:#ddd"><td>ERROR_VALIDATE_SEMANTIC </td><td>La validation semantique a échoué (%s). </td><td>36 </td></tr><tr style="background:#ddd"><td>ERROR_MERGE_REPORTS </td><td>La fusion des rapports a échoué (%s). </td><td>37 </td></tr><tr style="background:#ddd"><td>ERROR_FORMATER_INI_CANNOT_ADD_VALUE </td><td>L&#8217;ajout de la valeur %s est immpossibe. Le nombre de valeur ne doit pas être plus grand que le nombre de titre %d. </td><td>38 </td></tr><tr style="background:#ddd"><td>ERROR_FORMATER_INI_NOT_EQUAL_LIST_SIZE </td><td>L&#8217;initalisation de formateur n&#8217;est pas correcte. Le nombre de %s %d et de %s %d est diffrent </td><td>39 </td></tr><tr style="background:#ddd"><td>ERROR_FORMATER_INI_NOT_PREPARE_METHOD_EXECUTED </td><td>L&#8217;initalisation du formateur n&#8217;est pas correcte. La mthode prepareValueLineSeparator n&#8217;a pas t invoqu </td><td>40 </td></tr><tr style="background:#ddd"><td>ERROR_ZIP_FILE_ACCESS </td><td>L&#8217;accès au fichier zip &#8249;%s&#8250; a échoué (%s). </td><td>41 </td></tr><tr style="background:#ddd"><td>CANNOT_CLOSE_ZIP_FILE </td><td>La fermeture du fichier Zip prcdent &#8249;%s&#8250; a échoué. (%s). </td><td>42 </td></tr><tr style="background:#ddd"><td>ERROR_EXTRACT_SALARIE_MSG_LIST </td><td>L&#8217;extraction des salaris du message a échoué (%s). </td><td>43 </td></tr><tr style="background:#ddd"><td>ERROR_EXPORT_IMPORT_TEMPLATE </td><td>Le template n&#8217;a pas pu être import, le projet (%s) est introuvable. </td><td>44 </td></tr><tr style="background:#ddd"><td>ERROR_SERIALISATION_REPORT_HEADLESS </td><td>Le fichier de destination n&#8217;a pu être sérialisé </td><td>45 </td></tr><tr style="background:#ddd"><td>ERROR_TECHNIC_VALIDATION </td><td>Une erreur technique s&#8217;est produite lors de la validation. Veuillez regarder la vue erreur log pour plus de détails. </td><td>46 </td></tr><tr style="background:#ddd"><td>ERROR_TECHNIC_EXPORT </td><td>Une erreur technique s&#8217;est produite lors de l&#8217;export. Veuillez regarder la vue erreur log pour plus de détails. </td><td>47 </td></tr><tr style="background:#ddd"><td>ERROR_OPENING_ERROR_LOG </td><td>Une erreur technique s&#8217;est produite lors de l&#8217;ouverture de la vue error log. </td><td>48 </td></tr><tr style="background:#ddd"><td>ERROR_SALARIE_VIEW_INITIALIZATION </td><td>Une erreur technique s&#8217;est produite lors de l&#8217;ouverture de la vue salarié. </td><td>49 </td></tr><tr style="background:#ddd"><td>ERROR_SALARIE_VIEW_REFRESH </td><td>Une erreur technique s&#8217;est produite lors du rafraîchissement de la vue salarié. </td><td>50 </td></tr><tr style="background:#ddd"><td>ERROR_NORME_VIEW_REFRESH </td><td>Une erreur technique s&#8217;est produite lors du rafraîchissement de la vue norme. </td><td>51 </td></tr><tr style="background:#ddd"><td>ERROR_NORME_VIEW_INITIALIZATION </td><td>Une erreur technique s&#8217;est produite lors de l&#8217;ouverture de la vue norme. </td><td>52 </td></tr><tr style="background:#ddd"><td>ERROR_PRINCIPAL_VIEW_REFRESH </td><td>Une erreur technique s&#8217;est produite lors du rafraîchissement de la vue principale. </td><td>53 </td></tr><tr style="background:#ddd"><td>ERROR_PRINCIPALVIEW_INITIALIZATION </td><td>Une erreur technique s&#8217;est produite lors de l&#8217;ouverture de la vue principale. </td><td>54 </td></tr><tr style="background:#ddd"><td>ERROR_NORME_VIEW_REFRESH </td><td>Une erreur technique s&#8217;est produite lors du rafraîchissement de la vue norme. </td><td>55 </td></tr><tr style="background:#ddd"><td>ERROR_NORME_VIEW_INITIALIZATION </td><td>Une erreur technique s&#8217;est produite lors de l&#8217;ouverture de la vue norme. </td><td>56 </td></tr><tr style="background:#ddd"><td>ERROR_PRINCIPAL_VIEW_REFRESH </td><td>Une erreur technique s&#8217;est produite lors du rafraîchissement de la vue principale. </td><td>57 </td></tr><tr style="background:#ddd"><td>ERROR_PRINCIPALVIEW_INITIALIZATION </td><td>Une erreur technique s&#8217;est produite lors de l&#8217;ouverture de la vue principale. </td><td>58 </td></tr><tr style="background:#ddd"><td>ERROR_CANNOT_RETRIEVE_BUNDLE </td><td>Le bundle de la norme &#8249;%s&#8250; n&#8217;a pu être r\u00E9cup\u00E9rer : </td><td>60 </td></tr><tr style="background:#ddd"><td>CANNOT_CREATE_NORME_DESCRIPTOR </td><td>La norme dont l&#8217;identifiant est &#8249;%s&#8250; ne correspond à aucune norme installée. La liste des normes installées est la suivante : </td><td>61 </td></tr><tr style="background:#ddd"><td>ERROR_NO_NORMS_REGISTERED </td><td>Il n&#8217;y a aucune norme install\u00E9e dans le produit. </td><td>62 </td></tr><tr style="background:#ddd"><td>ERROR_CANNOT_INSTANCIATE_DESCRIPTOR </td><td>La création du norme descripteur de la norme &#8249;%s&#8250; a échouée. </td><td>70 </td></tr><tr style="background:#ddd"><td>ERROR_CLASS_INSTANCIATED_IS_NOT_DESCRIPTOR </td><td>Le type fourni par la norme %s qui permet de créer un descripteur de norme ne correspond pas à un type attendu. </td><td>71 </td></tr><tr style="background:#ddd"><td>ERROR_CANNOT_INSTANCIATE_SERIALIZER </td><td>La création du sérialiseur de la norme &#8249;%s&#8250; a échoué </td><td>72 </td></tr><tr style="background:#ddd"><td>ERROR_CLASS_INSTANCIATED_IS_NOT_SERIALIZER </td><td>Le type fourni par la norme %s qui permet de créer un sérialiseur ne correspond pas à un type attendu. </td><td>74 </td></tr><tr style="background:#ddd"><td>EC_JAVA_VERSION </td><td>La version de java utilise (&#8249;%s&#8250;) n&#8217;est pas bonne. Vous devez utiliser une verion 1.6 &#8211; 32 bits (configurer la variable DSNVAL_JAVA) </td><td>99 </td></tr><tr style="background:#ddd"><td>EC_JAVA_ARCHI </td><td>La version de java utilise est une version 64 bits. Vous devez utiliser une verion 1.6 &#8211; 32 bits  (configurer la variable DSNVAL_JAVA) </td><td>98 </td></tr></table><p>Le code retour de la commande peut être récupérer dans la variable ? ( echo $? ) dans un shell bash sous linux et la variable errorlevel sous windows ( echo %errorlevel% ).</p><h2 id="Configurationjava">Configuration java</h2><p>Par dfaut, les scripts de lancement prennent le java qui est dfini dans le path du système. Si ce java n&#8217;est pas compatible avec le produit (Java 1.6 en version 32-Bit) un message nous indiquera que la version utilise n&#8217;est pas valide.</p><p>Nous pouvons configurer la version utilise en valorisant la variable DSNVAL_JAVA avec le chemin de l&#8217;excutable java voulu. Voici les commandes de configuration&#xa0;:</p><p>Pour Windows&#xa0;:</p><pre><code>set DSNVAL_JAVA=c:\path\to\java.exe
</code></pre><p>Pour Linux&#xa0;:</p><pre><code>export DSNVAL_JAVA=/path/to/java
</code></pre><h2 id="Encodingsouswindows">Encoding sous windows</h2><p>Pour que les accents soient correctement restitus sous windows, deux actions peuvent être ralises : </p><ul><li>Lancer le changement d&#8217;encoding de la console en CP1252 grâce à la commande &#8249;chcp 1252&#8250;,</li><li>Mettre la police de la console à une police TrueType si ce n&#8217;est pas djà la cas. Par exemple, la police &#8249;Police Raster&#8250; n&#8217;est pas TrueType alors que la police &#8249;Lucida Console&#8250; en est une.</li></ul></body></html>